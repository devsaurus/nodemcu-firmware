sudo: false
language: cpp
addons:
  apt:
    packages:
    - python-serial
    - srecord
    - gperf
cache:
  directories:
    - cache
install:
  - export PATH=$PWD/tools/toolchains/esp8266/bin:$PWD/tools/toolchains/esp32/bin:$PATH
script:
- sed -i -e 's,../include,$(PROJECT_PATH)/build/include,' sdk/esp32-esp-idf/components/esp32/component.mk # Temporary workaround: delete broken idf dependency
- export BUILD_DATE=$(date +%Y%m%d)
- env BUILD_DIR_BASE=build/float make MORE_CFLAGS="-DBUILD_DATE='\"'$BUILD_DATE'\"'" defconfig all
- env BUILD_DIR_BASE=build/integer make MORE_CFLAGS="-DLUA_NUMBER_INTEGRAL -DBUILD_DATE='\"'$BUILD_DATE'\"'" defconfig all
# http://docs.travis-ci.com/user/environment-variables/#Convenience-Variables
#- if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then bash "$TRAVIS_BUILD_DIR"/tools/pr-build.sh; fi
